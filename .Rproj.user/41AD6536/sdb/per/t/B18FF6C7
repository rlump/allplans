{
    "contents" : "processWB <- function(hhsdata,plans) {\n  #read.xlsx(\"hhsStateData.xls\",sheetIndex=1) -> hhsdata\n  #plans <- read.csv(\"out\",colClasses = \"character\")\n  #plans[,5] <- as.numeric(plans[,5])\n  #plans[complete.cases(plans),] -> plans\n  #statePops <- read.csv(\"./statepop.csv\")\n  start <- 120\n  end <- nrow(hhsdata)\n  as.numeric.factor <- function(x) {(as.numeric(levels(x)))[x]}\n  states = character()\n  types = character()\n  df <- data.frame()\n  while (start < end) {\n    states <- c(states,as.character(hhsdata[start,2]))\n    types <- c(types,as.character(hhsdata[start+4,7]))\n    df <- rbind(df,c(as.numeric.factor(hhsdata[start+4,15]),as.numeric.factor(hhsdata[start+5,15]),\n                     as.numeric.factor(hhsdata[start+10,15]),as.numeric.factor(hhsdata[start+11,15]),\n                     as.numeric.factor(hhsdata[start+16,15]),as.numeric.factor(hhsdata[start+17,15]),\n                     as.numeric.factor(hhsdata[start+18,15]),as.numeric.factor(hhsdata[start+19,15]),\n                     as.numeric.factor(hhsdata[start+20,15]),\n                     as.numeric.factor(hhsdata[start+10,8]),as.numeric.factor(hhsdata[start+11,8]),\n                     as.numeric.factor(hhsdata[start+16,8]),as.numeric.factor(hhsdata[start+17,8]),\n                     as.numeric.factor(hhsdata[start+18,8]),as.numeric.factor(hhsdata[start+19,8]),\n                     as.numeric.factor(hhsdata[start+20,8]),as.numeric.factor(hhsdata[start+21,8]),\n                     as.numeric.factor(hhsdata[start+22,8])\n                     ))\n    start <- start + 38\n  }\n  df <- cbind(df,types)\n  df <- cbind(df,states)\n  c(state.abb[1:8],\"DC\",\"FFM\",state.abb[9:50]) -> statesAbb\n  df <- df[order(df$state),]\n  df <- cbind(df,statesAbb)\n\n  names(df) <-  c(\"numplans\",\"chgmedicaid\",\"subsidy\",\"nosubsidy\",\"bronze\",\"silver\",\"gold\",\"platinum\",\"catastrophic\",\n                  \"male\",\"female\",\"age<18\",\"age 18-25\",\"age 26-34\",\"age 35-44\",\"age 45-54\",\"age 55-64\",\n                  \"age > 65\",\"exchangetype\",\"state\",\"stateabb\")\n  sapply(as.character(df[,\"stateabb\"]),function(x) {length(stateCarriers[[x]])} ) -> stateCarrierNums\n  stateCarrierNums[stateCarrierNums == 0] <- NA\n  df <- cbind(df,stateCarrierNums)\n  df[,\"nosubsidy\"]/(df[,\"subsidy\"] + df[,\"nosubsidy\"]) -> df$nosubFraction\n  df <- cbind(df,statePops)\n  df\n}",
    "created" : 1400002531839.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2056181079",
    "id" : "B18FF6C7",
    "lastKnownWriteTime" : 1401747645,
    "path" : "~/RailApps/allplans/processWB.R",
    "project_path" : "processWB.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : true,
    "type" : "r_source"
}